{% from "macros.tmpl" import wrap_with_condition, license -%}
{{ license() }}

#ifndef RuntimeEnabledFeatures_h
#define RuntimeEnabledFeatures_h

#include "platform/PlatformExport.h"

namespace WebCore {

// A class that stores static enablers for all experimental features.

class PLATFORM_EXPORT RuntimeEnabledFeatures {
public:

{%- for feature_set in feature_sets %}
    static void set{{feature_set|capitalize}}FeaturesEnabled(bool);
{%- endfor %}

#if !defined(NDEBUG) || defined(S_UNITTEST_SUPPORT)
{% for feature in features %}
{%- if feature.custom %}
    static bool {{feature.first_lowered_name}}Enabled();
{%- else %}
{%- if feature.condition %}
#if ENABLE({{feature.condition}})
{%- endif %}
    static void set{{feature.name}}Enabled(bool isEnabled) { is{{feature.name}}Enabled = isEnabled; }
    static bool {{feature.first_lowered_name}}Enabled() { return {{feature.enabled_condition}}; }
{%- if feature.condition %}
#else
    static void set{{feature.name}}Enabled(bool) { }
    static bool {{feature.first_lowered_name}}Enabled() { return false; }
#endif
{%- endif %}
{%- endif %}
{% endfor %}
#else

{%- for feature in features if (feature.force == "no") %}
{%- if feature.custom %}
    static bool {{feature.first_lowered_name}}Enabled();
{%- else %}
{%- if feature.condition %}
#if ENABLE({{feature.condition}})
{%- endif %}
    static void set{{feature.name}}Enabled(bool isEnabled) { is{{feature.name}}Enabled = isEnabled; }
    static bool {{feature.first_lowered_name}}Enabled() { return {{feature.enabled_condition}}; }
{%- if feature.condition %}
#else
    static void set{{feature.name}}Enabled(bool) { }
    static bool {{feature.first_lowered_name}}Enabled() { return false; }
#endif
{%- endif %}
{%- endif %}
{% endfor %}

{%- for feature in features if (feature.force != "no" and feature.force != "disable" and (feature.status == "stable" or feature.force == "enable")) %}

{%- if feature.condition %}
#if ENABLE({{feature.condition}})
{%- endif %}
    inline static void set{{feature.name}}Enabled(bool) { }
    inline static bool {{feature.first_lowered_name}}Enabled() { return true; }
{%- if feature.condition %}
#else
    inline static void set{{feature.name}}Enabled(bool) { }
    inline static bool {{feature.first_lowered_name}}Enabled() { return false; }
#endif
{%- endif %}
{%- endfor %}

{% for feature in features if (feature.force != "no" and feature.force != "enable"  and (feature.status != "stable" or feature.force == "disable")) %}
    inline static void set{{feature.name}}Enabled(bool) { }
    inline static bool {{feature.first_lowered_name}}Enabled() { return false; }
{% endfor %}
#endif

private:
    RuntimeEnabledFeatures() { }
#if !defined(NDEBUG) || defined(S_UNITTEST_SUPPORT)
{% for feature in features if not feature.custom %}
{%- call wrap_with_condition(feature.condition) %}
    static bool is{{feature.name}}Enabled;
{%- endcall %}
{%- endfor %}
#else
{% for feature in features if not feature.custom and feature.force == "no" %}
{%- call wrap_with_condition(feature.condition) %}
    static bool is{{feature.name}}Enabled;
{%- endcall %}
{%- endfor %}
#endif
};

} // namespace WebCore

#endif // RuntimeEnabledFeatures_h
